name: Docker Coutinus Integration with Github
 

on:
  schedule:
    - cron: '20 6 * * *'
  push:
    branches: [ "main" ]
    # Publish semver tags as releases.
    tags: [ 'v*.*.*' ]
  pull_request:
    branches: [ "main" ]
 

jobs:
  build:

    runs-on: ubuntu-latest
    
    steps:
      - name: Login into DockerHub
        uses: docker/login-action@v3.3.0
        with:
           username:  ${{ secrets.DOCKER_HUB_USER}}
           password: ${{ secrets.DOCKER_HUB_PASSWORD}}
        
      - name: Setup Java SDK 
        uses: actions/setup-java@v4.5.0
        with:
           java-version: 17
           distribution: temurin
    
    
      - name: Build NamingServer Microservice Docker Container 
        run: |
          cd namingserver
          mvn spring-boot:build-image -DskipTests 
      
      - name: Build Book Microservice Docker Container 
        run: |
          cd bookservice
          mvn spring-boot:build-image -DskipTests 
      
      - name: Build Api Gateway Docker Container 
        run: |
          cd api-gateway
          mvn spring-boot:build-image -DskipTests 
      
      - name: Build Cambio Microservice Docker Container 
        run: |
          cd cambioservice
          mvn spring-boot:build-image -DskipTests 
      
      - name: Docker Compose Build 
        working-directory: ./course
        run: docker compose build

 
 
